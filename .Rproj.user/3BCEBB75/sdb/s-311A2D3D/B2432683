{
    "contents" : "#  simulate a MA(2) sequence of size n\nphi <- 0\ntheta <- c(0.6,0.2)\nn <- 100\n#set.seed(456)\nset.seed(4565)\nx <- arima.sim(n = n, list( ma = theta),sd=10) \n \n\n## plot x and sample acf, pacf\nlayout(1:3)\nplot(x,type=\"o\")\nacf(x)\npacf(x)\n\n# fit MA(2)\nma.2 <- arima(x, order=c(2,0,0))\nma.2$coef   # value of p+q+1 parameters est. in ARMA(p,q)\nma.2$var.coef        # \n\n# test for mu=0\nz <- (ma.2$coef[3]-0)/sqrt(ma.2$var.coef[3,3])  # test statistic\n# 1-qnorm(abs(z)) # p-value\ncat(\"The p-value for testing mu=0:\",1-pnorm(abs(z)),\"\\n\")\n\n# fit with MA(2) with mu=0\nma.2 <- arima(x, order=c(2,0,0), include.mean =FALSE)\nma.2$coef   # value of p+q parameters est. in ARMA(p,q)\nma.2$var.coef        \n# test theta_2=0\nz <- as.numeric(ma.2$coef[2]-0)/sqrt(ma.2$var.coef[2,2])  # test statistic\n# 1-qnorm(abs(z)) # p-value\ncat(\"The p-value for testing theta_2=0:\", 1-pnorm(abs(z)),\"\\n\")\n\n\n# est. var of MLE given by formula\ntheta.hat <- ma.2$coef\nvar.ma.2.hat <- diag(0,2)\nvar.ma.2.hat[1,1] <- (1-theta.hat[2])^2\nvar.ma.2.hat[2,2] <-  (1-theta.hat[2])^2\nvar.ma.2.hat[2,1] <- var.ma.2.hat[1,2] <-  theta.hat[1]*(1-theta.hat[2])\n(var.ma.2.hat  <- 1/n*var.ma.2.hat ) \n# test theta_2=0\nz <- as.numeric(ma.2$coef[2]-0)/sqrt(var.ma.2.hat[2,2])  # test statistic\n# 1-qnorm(abs(z)) # p-value\ncat(\"The p-value for testing theta_2=0:\", 1-pnorm(abs(z)),\"\\n\")\n\n\n\nres <- residuals(ma.2) # or ma.2$residuals\nlayout(1:3)\nplot(res,type=\"o\",main=\"Residual Plot\")\n\n#plot(res/ma.2$sigma2^.5,type=\"o\",main=\"standardized residuals\")\n\n# plot sample ACF and sample PACF of the res\n#layout(1:2)\nacf(res, main=\"sample ACF of the standardized innovations\")\npacf(res, main=\"sample PACF of the standardized innovations\") \n\n\n\n#Ljung-Box for  H_0: \\rho(1)=\\rho(2)=\\cdots=\\rho(h)=0\nh<- 10\n# wrong d.f. for the Ljung-Box test\nBox.test(res, lag=h,  type = \"Ljung-Box\")\n\nc2 <- acf(res,plot=F,lag=h)$acf[-1]\nj <- 1:h\nljung.box.statistic <- n*(n+2) *sum(c2^2/(n-j))\n#The p-value for Ljung-Box with h=10\np <- 0; q <- 2\n1-pchisq(ljung.box.statistic,h-p-q)\n\n# wrong d.f. for the Ljung-Box test\ntsdiag(ma.2)\n\n\n",
    "created" : 1446483753114.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2178965887",
    "id" : "B2432683",
    "lastKnownWriteTime" : 1446481900,
    "path" : "/Volumes/stat/Course_Data/4280/lab11.02.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}